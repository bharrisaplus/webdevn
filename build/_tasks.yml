# yaml-language-server: $schema=https://taskfile.dev/schema.json


# Building example
#   task build:rear-win


version: '3'


includes:
  winbuild: ./win/_tasks.yml
  macbuild: ./mac/_tasks.yml
  gnubuild: ./gnu/_tasks.yml


vars:
  GNU_X64_BUILD_OUTPUT_DIR:
    "{{.BUILD_ROOT}}/gnu/x64"

  GNU_ARM64_BUILD_OUTPUT_DIR:
    "{{.BUILD_ROOT}}/gnu/arm64"

  MAC_DARWIN_BUILD_OUTPUT_DIR:
    "{{.BUILD_ROOT}}/mac/darwin"

  WIN_X64_BUILD_OUTPUT_DIR:
    "{{.BUILD_ROOT}}/win/x64"

  BUILD_CONFIG_DIR:
    "{{.PROJECT_DIR}}/build"

  BUILD_NIMDEFINEFLAGS:
    '-d:release {{.NIMDEFINEFLAGS}}'


tasks:

  # build aliases for default (x64) convenience

  rear-winbuildx64:
    aliases: [rear-win]
    cmds:
      - task: winbuild:rear-x64

  wrap-winbuildx64:
    aliases: [wrap-win]
    cmds:
      - task: winbuild:wrap-x64

  sweep-winbuildx64:
    aliases: [sweep-win]
    cmds:
      - task: winbuild:sweep-x64


  rear-macdabuildx64:
    aliases: [rear-mac]
    cmds:
      - task: macbuild:rear-darwinx64

  wrap-macdabuildx64:
    aliases: [wrap-mac]
    cmds:
      - task: macbuild:wrap-darwinx64

  sweep-macdabuildx64:
    aliases: [sweep-mac]
    cmds:
      - task: macbuild:sweep-darwin


  rear-gnubuildx64:
    aliases: [rear-gnu]
    cmds:
      - task: gnubuild:rear-x64

  wrap-gnubuildx64:
    aliases: [wrap-gnu]
    cmds:
      - task: gnubuild:wrap-x64

  sweep-gnubuildx64:
    aliases: [sweep-gnu]
    cmds:
      - task: gnubuild:sweep-x64

  rear-gnubuildarm64:
    aliases: [rear-gnuarm]
    cmds:
      - task: gnubuild:rear-arm64

  wrap-gnubuildarm64:
    aliases: [wrap-gnuarm]
    cmds:
      - task: gnubuild:wrap-arm64

  sweep-gnubuildarm64:
    aliases: [sweep-gnuarm]
    cmds:
      - task: gnubuild:sweep-arm64
